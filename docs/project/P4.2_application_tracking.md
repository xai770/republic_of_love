---
id: P4.2
title: "Application Tracking"
phase: 4
status: done
owner: arden
priority: medium
depends_on: [P3.3]
effort: 4h
completed: 2026-01-27
---

# P4.2 Application Tracking

## Goal

Let users track which jobs they applied to, providing:
- Personal organization ("Did I apply?")
- Outcome data for algorithm improvement

## Schema

```sql
CREATE TABLE applications (
    id SERIAL PRIMARY KEY,
    match_id INTEGER NOT NULL REFERENCES profile_posting_matches(id),
    user_id INTEGER NOT NULL REFERENCES users(id),
    status VARCHAR(20) NOT NULL DEFAULT 'applied',
    applied_at TIMESTAMPTZ DEFAULT NOW(),
    outcome VARCHAR(20),
    outcome_at TIMESTAMPTZ,
    notes TEXT,
    UNIQUE(match_id, user_id)
);

-- Status: applied, interviewing, offered, rejected, withdrawn
-- Outcome: hired, rejected, ghosted, withdrew
```

## User Flow

1. User views match in dashboard
2. Clicks "I Applied" button
3. Match card updates with status badge
4. Later, user updates outcome (optional)

## API Endpoints

```python
@app.post("/matches/{id}/applied")
def mark_applied(match_id: int, user: User = Depends(get_current_user)):
    # Verify ownership
    match = verify_match_ownership(db, match_id, user.id)
    
    db.execute(insert(Application).values(
        match_id=match_id,
        user_id=user.id,
        status='applied'
    ).on_conflict_do_nothing())
    
    return {"status": "applied"}

@app.patch("/applications/{id}")
def update_application(
    app_id: int, 
    update: ApplicationUpdate,
    user: User = Depends(get_current_user)
):
    app = db.get(Application, app_id)
    if app.user_id != user.id:
        raise HTTPException(403)
    
    if update.status:
        app.status = update.status
    if update.outcome:
        app.outcome = update.outcome
        app.outcome_at = datetime.utcnow()
    if update.notes:
        app.notes = update.notes
    
    db.commit()
    return {"status": "updated"}
```

## UI Component

```html
<!-- Not applied yet -->
<button hx-post="/matches/123/applied" 
        hx-target="#app-status-123"
        class="apply-btn">
    I Applied
</button>

<!-- After applying -->
<div id="app-status-123" class="application-tracker">
    <span class="badge applied">Applied âœ“</span>
    <select hx-patch="/applications/456" hx-target="#app-status-123">
        <option value="applied" selected>Applied</option>
        <option value="interviewing">Interviewing</option>
        <option value="offered">Offered! ðŸŽ‰</option>
        <option value="rejected">Rejected</option>
        <option value="withdrew">Withdrew</option>
    </select>
</div>
```

## Analytics Value

Application outcome data is gold for matching algorithm:

```sql
-- Which score ranges lead to hires?
SELECT 
    CASE 
        WHEN m.weighted_score >= 0.80 THEN '0.80+'
        WHEN m.weighted_score >= 0.70 THEN '0.70-0.79'
        WHEN m.weighted_score >= 0.60 THEN '0.60-0.69'
        ELSE '< 0.60'
    END as score_range,
    a.outcome,
    COUNT(*) as count
FROM applications a
JOIN profile_posting_matches m ON m.id = a.match_id
WHERE a.outcome IS NOT NULL
GROUP BY 1, 2
ORDER BY 1, 2;

-- Time to hire by match score
SELECT 
    m.weighted_score,
    a.outcome,
    a.outcome_at - a.applied_at as time_to_outcome
FROM applications a
JOIN profile_posting_matches m ON m.id = a.match_id
WHERE a.outcome = 'hired';
```

## Acceptance Criteria

- [ ] "I Applied" button on each match
- [ ] Button changes to status dropdown after applying
- [ ] Status updates persist
- [ ] Outcome dropdown appears after applying
- [ ] Application list view shows all user's applications
- [ ] Filter by status (applied, interviewing, etc.)
- [ ] Data queryable for analytics
